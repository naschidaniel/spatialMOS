{% load static %}

<h3 class="mt-4">API query</h3>
<table class="table table-sm">
  <tbody>
    <tr>
      <th scope="row">{{ search_result.licence }}</th>
      <td>
        <a href="{{ query_url }}" target="_blank" rel="noreferrer">{{ search_result.query_url }}</a>
      </td>
    </tr>
    {% for key, value in search_result.api_data.items %}
    <tr>
      <th scope="row">{{ key }}</th>
      <td>{{ value }}</td>
    </tr>
    {% endfor %}
    {% if search_result.spatialmos_api_url %}
    <tr>
      <th scope="row">moses.tirol Prediction: </th>
      <td>
        <a href="{{ spatialmos_api_url }}" target="_blank" rel="noreferrer">{{ search_result.spatialmos_api_url }}</a>
      </td>
    </tr>
    {% endif %}
  </tbody>
</table>

<div id="map" style="height:400px;"></div>

<script type="text/javascript">
  // Creating map options
  var lat = "{{ search_result.osm_data.lat }}"
  var lon = "{{ search_result.osm_data.lon }}"

  // Creating map options
  var map = L.map('map', {
    center: [lat, lon],
    zoom: 14
  });

  // Creating a Layer object
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?{foo}', { foo: 'bar', attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>' }).addTo(map);
  
  // add a marker object
  var marker = L.marker([lat, lon]).addTo(map);
  marker.bindPopup("{{ search_result.osm_data.display_name }}").openPopup();

</script>

<!-- We will put our React component inside this div. -->
<div id="like_button_container"></div>

<!-- Load React. -->
  {% if DEBUG %}
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
  {% else %}
    <script src="https://unpkg.com/react@16/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js" crossorigin></script>
  {% endif %}

<!-- Load React component. -->
<script src="{% static './js/components/like_button.js' %}"></script>
